# Authentication Flaws

Change username in cookies... duh!

Decode values in cookies... e.g. this is MD5 of username.

Are username comparisons done the same on the FE, BE, and DB layers?  
* Can we register a new user with a "different" name, e.g. "admin" vs "ADMIN"?
* Can we rely on whitespace being handled differently or being trimmed, e.g. "admin" vs "admin "?

Is data leaked in the response body of redirects to the login page, due to the HTTP response not being terminated correctly?

## Mass Assignment

Assign properties you are not supposed to be able to assign, due to "active record" pattern being used by developers, e.g. in Ruby on Rails:

* Add extra properties that aren't documented, e.g. `user[admin]=1`, during create/update commands.
* Set relationships using foreign keys, e.g. `user[organisation_id]=1`

## Code Injection

Find "invisible" parameter injection values to test and ensure you have a code injection:

* By injecting inline comments inside your values, e.g. `/* random value */`.
* By injecting a concatenation, e.g. `.` or `+`, with potential quotes to start/end string sequences), e.g. `."ha"."cker".`

Find "time-based" parameter injection values to test and ensure you have a code injection:

* Plain call without a `sleep` (or calling it with a delay of zero `sleep(0)`)
* An injected call with a long, detectable delay `sleep(10)`

Find error causing parameter injection values to test and ensure you have a code injection:

* Single unterminated string quotes, e.g. `'` or `"`

Make sure the injected value is "valid" and that subsequent code is either commended out or changed to be legal:

* Know how to comment out the rest of the code, e.g. `//`, `#`, `--`, to terminate the command, e.g. `.system('uname -a');#` or `.system('uname -a');//`
* By adding dummy code to make the syntax legal, e.g. `.system('uname -a'); $dummy="`

Beware of URL or other encodings needed to ensure your injections end up in the correct syntax at the location of execution.

### PHP

Injections into PHP `usort` are put inside curly braces `{...}` that need to be terminated correctly (CVE-2008-4096), e.g. `);}system('uname%20-a');//`.  Despire warnings being shown, code still executes!

Another very dangerous modifier exists in PHP regular expressions: `PCRE_REPLACE_EVAL` or `/e` (deprecated as of PHP 5.5.0 ).